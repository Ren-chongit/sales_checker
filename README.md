# Maching (Sales Checker)

原価CSVデータと振替PDFデータの照合を行うツールです。

## 概要
「原価データ（CSV）」と「振替済みデータ（PDF）」を読み込み、コードをキーにしてマッチングを行います。
金額の不一致や、片方にしか存在しないデータを検出し、Excelファイルとして出力します。

## 使用方法

1. **`Maching.exe` を起動します。**
   - フォルダ内に実行ファイルがあります。
   - ショートカットなどをデスクトップに作成してご利用ください。

2. **原価データファイル (CSV) を選択します。**
   - ファイル選択ダイアログが表示されます。

3. **振替済みデータファイル (PDF) を選択します。**
   - 続いてPDF選択ダイアログが表示されます。

4. **処理結果が保存されます。**
   - 処理が完了すると、CSVファイルと同じフォルダに `yyyymmddマッチング済み.xlsx` が作成されます。
   - Excelファイルを開き、黄色（金額不一致）や赤色（コード不一致）のセルを確認してください。

## 開発環境

*   **言語**: Python 3.11+
*   **パッケージ管理**: uv
*   **主要ライブラリ**:
    *   pandas: データ処理
    *   pdfplumber: PDFテキスト抽出
    *   openpyxl: Excel出力
    *   tk: GUIファイル選択

## ビルド方法 (exe化)

ソースコードからexeファイルを作成する場合の手順です。

1. 依存関係のインストール:
   ```powershell
   uv sync
   ```

2. exe作成コマンドの実行:
   ```powershell
   uv run pyinstaller --clean --noconfirm --onefile --windowed --icon "icon_I.ico" --name "Maching" main.py
   ```
   ※ `create_icons_v3.py` を実行してアイコンファイル (`icon_I.ico`) を事前に生成しておく必要があります。

## ファイル構成

*   `main.py`: アプリケーション本体のソースコード
*   `dist/Maching.exe`: 実行ファイル (完成品)
*   `test_files/`: 開発用スクリプト、アイコン素材、ログなどの退避場所
